#### 파이썬 코드를 정돈하기 위한 패턴



##### `assert`문으로 방어하기

- 단언문 `assert`문이 뭐고, 왜 사용해야 하지?

  > 프로그램 안정성을 높이고 프로그램을 쉽게 디버그 할 수 있다. - 책 본문중

  - 단언문 예제

    ```python
    def apply_discount(product, discount):
        price = int(product['price'] * (1.0 - discount))
        assert 0 <= price <= product['price']
        return price
    ```

  > 계산된 할인 가격은 `0` 보다 작을수 없고, 할인 가격은 실제 물건 가격보다 클 수 없다.
  >
  > assert를 활용하여 실제로 의도한 대로 작동하는지 확인한다.
  >
  > assert를 사용하는 가장 큰 이유는 문제가 생겼을때 프로그램을 쉽게 디버깅 할 수 있다는 것이다.



- 그냥 일반적인 예외 처리를 사용하면 안되나?

  > 단언문을 사용한다는 것은 예상할 수 있는 예외를 처리하고자 함이 아니다.
  >
  >  `File-Not-Found` 같이 파일을 찾지 못하면, 사용자가 적절히 예외를 처리하듯 예상되는 예외를 
  >
  > 처리하고자 단언문을 사용하는 것이 아니라, 진짜 프로그램에 에러가 있는지 확인하고,
  >
  > 에러 발생시 디버깅이 수월하게 하는 목적으로 사용한다.
  >
  > 단언문은 런타임 에러를 처리하기 위한 메커니즘이 아니라 디버깅을 돕는 것임을 명심하자.(책 본문중)



- assert를 사용하면 안되는 경우

  - 데이터 검증용으로 사용하면 안됨

    > 파이썬 설정으로 assert를 무력화 할 수 있음. 
    > 만약 들어온 유저가 관리자인지 판단하는 코드를 assert로 만들고 해당 설정이 꺼져있다면
    >
    > 어떤 유저든지 관리자 권한으로 접근하게 되는 우를 범할 수 있음.
    
    ```python
    def delete_product(prod_id, user):
        assert user.is_admin(), 'Must be admin'
        assert store.has_product(prod_id), 'Unknown product'
        store.get_product(prod_id).delete()
    ```
    
  - 절대 실패하지 않는 단언문
  
    > 항상 `참`이 되는 파이썬 단언문을 실수로 작성할 수 있다.
    > assert 문에서 첫 번째 인자로 `튜플`을 전달하면 그 단언문은 항상 참이 된다.
  
    ```python
    assert (1 == 2, 'This should fail')
    ```
  
    > lint에서 어느 정도 방어를 해주지만,  단언문 선언 후 해당 단언문이 반드시 실패되는지
    >
    > 테스트 해야 한다.



##### 보기 좋은 쉼표 배치

> 파이썬의 `리스트`, `딕셔너리`, `세트 상수` 항목을 추가, 제거할때 모든 행을 쉼표로 끝내라고, Trick에서는
>
> 권고하고 있다.
>
> 이유 중 하나는 항목을 추가 제거시에 변경사항을 알기 쉽게 때문인데,  git과 같은 버전관리 시스템은 행 기반이라 한줄안에서 수정되었다면 무엇이 수정되었는지 알기 힘들다.
>
> ```python
> names = ['Alice', 'Bob', 'Dilbert']
> 
> names = [
>     'Alice',
>     'Bob',
>     'Dilbert'
> ]
> ```
>
> 하지만 여기서도 문제가 있다. 만약 `Jane`이라는 이름을 추가하려고 한다면, 두가지 작업을 해줘야 한다.
>
> 하나는 Jane을 추가하고 다른 하나는 `Dilbert`에게 `,` 컴마를 붙여줘야 한다.
>
> 만약 컴마를 잊어버린 다면, 의도치 않은 버그가 발생된다. (컴마를 안붙여도 문제가 발생안된다 제길!!)
>
> ```python
> names = [
>     'Alice',
>     'Bob',
>     'Dilbert'   # <- 쉼표가 빠졌다!
>     'Jane'
> ]
> >>> names
> ['Alice', 'Bob', 'DilbertJane']  # 붙어 나와버린다. 둘이 연인인가보다.
> ```
>
> 이것은 파이썬의 `문자열 리터럴 결합`이라고 하는 의도적인 문서화 동작인데
>
> 예를 들어 긴 문자열 상수를 여9러 줄로 나누는데 필요한 백슬래시 수를 줄이기 위해 사용된다.
>
> ```python
> my_str = ('1111111111111111111111111111111'
>           ',22222222222222222222222222222'
>           ',33333333333333333333333333333')
> ```
>
>
> 그러면 이런 실수를 어떻게 예방 할 수 있을까? 그것은 바로 모든 항목에 컴마를 붙이는 것이다.
>
> 파이썬에서는 리스트, 딕셔너리, 세트 상수의 모든 항목(마지막 항목도 포함)에 쉼표를 붙일 수 있다.
>
> 그러니깐 마지막에든 중간에든 항목을 추가할때는 컴마를 꼭 뿥여서 넣는 것이다.
>
> 